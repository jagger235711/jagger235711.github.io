---
authors: 
    - Jagger
categories:
  - 技术分享
date: 2023-11-04
draft: true
comments: true
---
# drf框架学习分享

django rest framework-一个基于Django的REST框架，用于构建Web API

接下来我会分享关于我在学习drf过程中的一些心得体会，以及一些遇到的问题和解决方法。
<!--more-->

## FBV&CBV

### fbv-function base view

要通过手动的方式对不同的请求方式进行处理

### cbv-class base view

django原生cbv： 通过继承View类，调用View中的dispatch实现不同请求方式的路由

基于drf的cbv：

## request对象

drf中的request不是原生的，它对python中原有的request进行了封装，封装了request.data，request.query_params等属性，方便我们使用。

但是可以通过drf中的request.xxx（相当于request._request.xxx）获取到python中的request.xxx属性。因为drf中通过`getattr`,`__getattr__`, `__getattribute__`方法，使得这些查找参数的过程对我们透明了。

查找的逻辑是： 先在本对象找该参数，如果找不到，则去原生request中找，如果找不到，则报错

```python
 def __getattr__(self, attr):
        """
        If an attribute does not exist on this instance, then we also attempt
        to proxy it to the underlying HttpRequest object.
        """
        try:
            return getattr(self._request, attr)
        except AttributeError:
            return self.__getattribute__(attr)
```

### `getattr`,`__getattr__`, `__getattribute__`和`__get__`的区别

<https://zhuanlan.zhihu.com/p/67586184>
这个页面是关于Python中的几个常用的方法和函数，它们的作用和区别。页面的主要内容如下：

- `getattr()`函数：这是一个内置的函数，可以用来获取对象的属性和方法。
  
  如果对象不存在该属性，可以设置一个默认值，否则会报错。
- `__getattr()__`和`__getattribute__()`魔法方法：这两个方法是在访问对象属性时被调用的。
  
  `__getattribute__()`方法总是会被调用，无论属性是否存在。如果属性不存在，就会调用`__getattr__()`方法，可以在这个方法里设置属性不存在时的默认值。
- `get()`方法：这是一个描述符方法，可以将访问对象属性转变为调用描述符方法。描述符可以在获取或者给对象赋值时对数据值进行一些特殊的加工和处理。@property装饰器就是通过描述符的方式实现的。描述符分为数据描述符和非数据描述符，区别在于是否实现了`__set__()`或`__del__()`方法。

### 类对象的魔法函数

Python中的类对象有很多魔法函数，它们是以双下划线开头和结尾的特殊方法。这些魔法函数可以让我们在类中自定义函数，并绑定到类的特殊方法中。这样，我们就可以在类的实例化对象上调用这些函数，从而实现一些特殊的功能。

以下是一些常见的类对象魔法函数：

- `__init__()`：构造函数，用于初始化对象的属性。
- `__str__()`：返回对象的字符串表示形式。
- `__new__()`：创建对象并返回它。
- `__unicode__()`：返回对象的Unicode字符串表示形式。
- `__call__()`：使对象可以像函数一样被调用。
- `__len__()`：返回对象的长度。
- `__repr__()`：返回对象的字符串表示形式，通常用于调试。
- `__setattr__()`：设置对象的属性。
- `__getattr__()`：获取对象的属性。
- `__getattribute__()`：获取对象的属性，与`__getattr__()`不同的是，它会在任何情况下都被调用。
- `__delattr__()`：删除对象的属性。
- `__setitem__()`：设置对象的索引值。
- `__getitem__()`：获取对象的索引值。
- `__delitem__()`：删除对象的索引值。
- `__iter__()`：返回一个迭代器。
- `__del__()`：析构函数，用于释放对象占用的资源。
- `__dir__()`：返回对象的属性列表。
- `__dict__()`：返回对象的属性字典。

以上是一些常见的类对象魔法函数

### 类的魔法函数与类的普通函数的区别

Python中的类有许多特殊的函数，也称为魔法函数。这些函数的名称以双下划线开头和结尾，例如`__init__`和`__str__`。这些函数与普通函数的区别在于，它们是类的特殊方法，可以在类中自定义函数并绑定到这些方法中。这些函数的调用方式也不同于普通函数，它们会在特定的情况下**自动调用**。例如，`__init__`函数是类的构造函数，用于初始化新创建的对象。当创建一个新的类实例时，`__init__`函数会自动调用。相反，普通函数需要显式调用才能执行。

另一个区别是，魔法函数可以让类增加一些额外的功能，方便使用者理解。例如，`__str__`函数可以让类的实例以字符串的形式输出，而不是默认的对象表示形式。这些函数的具体作用取决于它们的名称和用途，但它们都是用于增强类的功能和灵活性的。

希望这可以帮助您更好地理解Python中类的魔法函数和普通函数之间的区别。

### 类对象和实例对象

类对象和实例对象是Python中的两个重要概念。类对象是指在Python中定义的类，它是一个抽象的模板，用于创建具有相同属性和行为的多个对象。而实例对象则是根据类创建出来的一个个具体的“对象”，每个对象都拥有相同的方法，但各自的数据可能不同。例如，我们可以定义一个名为`Student`的类，然后创建多个不同的`Student`实例对象，每个实例对象都有自己的属性和方法。类对象和实例对象之间的主要区别在于，类对象是抽象的，而实例对象是具体的。如果你想了解更多关于类对象和实例对象的信息，可以参考这篇知乎文章²。

## 反射

在Python中，反射是指在运行时通过字符串的形式来访问、调用、修改或创建对象、模块、函数、类等的属性和方法的能力。反射使得我们可以根据程序运行时的状态来动态地操作对象，而不需要事先编写固定的代码。

Python中的反射主要借助于以下几个内置函数和特殊方法：

`getattr(object, name[, default])`：用于获取对象的属性或方法。参数object是待操作的对象，name是属性或方法的名称，default是可选参数，表示如果属性或方法不存在时返回的默认值。

`setattr(object, name, value)`：用于设置对象的属性或方法。参数object是待操作的对象，name是属性或方法的名称，value是要设置的值。

`hasattr(object, name)`：用于判断对象是否具有指定的属性或方法。参数object是待操作的对象，name是属性或方法的名称。

`delattr(object, name)`：用于删除对象的属性或方法。参数object是待操作的对象，name是属性或方法的名称。

`__dict__`：是一个特殊的字典属性，包含了对象的所有属性和方法。可以通过字典的方式操作这些属性和方法。

反射的使用可以在很多场景中发挥作用，比如动态地调用函数、根据用户输入执行不同的方法、动态地创建类或对象等。但需要注意，由于反射是基于字符串的，因此在使用时要注意安全性和错误处理，避免操控不当导致意外的结果。

在Python中，反射是指通过字符串来访问对象的属性和方法。通常情况下，我们会直接使用对象的属性或方法，比如`obj.attribute或obj.method()`。但是有时我们需要根据运行时的情况动态地访问对象，而不是提前知道需要访问的属性或方法的名称。

反射提供了一种灵活的方式来实现这个目的。我们可以通过字符串来获取对象的属性或方法，而不需要直接使用属性或方法的名称。这使得我们可以在运行时根据需要进行操作，而不需要提前定义所有的属性和方法。

举个例子，假设我们有一个叫obj的对象，并且我们希望通过字符串获取该对象的属性或方法，我们可以使用`getattr(obj, 'attribute')`来获取属性的值，或者使用`getattr(obj, 'method')()`来调用方法。

反射的应用场景很广泛，可以实现动态加载模块、调用不同的函数、动态调整对象的属性等等。通过反射，我们可以根据需要在运行时决定对象的行为，增加了程序的灵活性和动态性。但是需要注意的是，在使用反射时要谨慎，确保操作的安全性，并进行适当的错误处理。

## 一些零碎的点

1. 创建django项目时，通过指定目录可以将项目创建在当前目录而不是当前目录的子目录

    ```python
    django-admin startproject day13 .  #.代表在当前目录下创建项目
    ```

    在表示相对路径中，单点表示当前目录，双点表示上一级目录，反斜杠“/”表示分隔目录；

    相对路径特殊符号有以下几种表示意义：

    - 以“./”开头，代表当前目录和文件目录在同一个目录里，“./”也可以省略不写！

    - 以"../"开头：向上走一级，代表目标文件在当前文件所在的上一级目录；

    - 以"../../"开头：向上走两级，代表父级的父级目录，也就是上上级目录，再说明白点，就是上一级目录的上一级目录

    - 以"/”开头，代表根目录

2. 应用drf时首先要在settings.py中注册。因为可能要用到它的模板和静态文件。django会去已经注册了的app中寻找
3. oop：面向对象
